# NOTE: aws ecs cli tool only supports version 1 docker-compose file format
rabbitmq:
    image: rabbitmq
redis:
    image: redis
nginx:
    restart: always
    image: naphatkrit/tigerhost-nginx
    ports:
        - "80:80"
    links:
        - web:web
    volumes_from:
        - docs
docs:
    build: ./docs
web:
    restart: always
    image: naphatkrit/tigerhost-main
    command: bin/web.sh
    environment:
        DEIS_URL: http://deis.tigerhostapp.com
        BROKER_URL: amqp://guest:guest@rabbitmq:5672//
        CELERY_RESULT_BACKEND: redis://redis:6379/
        AWS_DEFAULT_REGION: us-east-1

        # TODO: fill out the actual values for these variables
        DATABASE_URL: postgres://user:pass@hostname:5432/db_name
        SECRET: abcdefghijklmnopqrstuvwxyz12345678910
        AWS_ACCESS_KEY_ID: AFDLJADSFaesFAKSRWae
        AWS_SECRET_ACCESS_KEY: zlksdfjaSFDAKLESFaSDf
    expose:
        - "8000"
    links:
        - redis:redis
        - rabbitmq:rabbitmq
worker:
    image: naphatkrit/tigerhost-main
    command: bin/worker.sh
    environment:
        DEIS_URL: http://deis.tigerhostapp.com
        BROKER_URL: amqp://guest:guest@rabbitmq:5672//
        CELERY_RESULT_BACKEND: redis://redis:6379/
        AWS_DEFAULT_REGION: us-east-1

        # TODO: fill out the actual values for these variables
        DATABASE_URL: postgres://user:pass@hostname:5432/db_name
        SECRET: abcdefghijklmnopqrstuvwxyz12345678910
        AWS_ACCESS_KEY_ID: AFDLJADSFaesFAKSRWae
        AWS_SECRET_ACCESS_KEY: zlksdfjaSFDAKLESFaSDf
    links:
        - redis:redis
        - rabbitmq:rabbitmq
